<!DOCTYPE html>
<html lang="es" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard de datos Â· Flor XR Lab</title>
  <link rel="stylesheet" href="css/styles.css" />
  <link rel="manifest" href="manifest.webmanifest" />
  <meta name="theme-color" content="#020617" />
  <link rel="icon" type="image/png" sizes="16x16" href="assets/img/favicon-16.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="assets/img/favicon-32.png" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  
<header class="top-bar">
  <div class="brand">
    <span class="brand-mark">ğŸŒ¸</span>
    <div class="brand-text">
      <div>XR Lab Â· AnatomÃ­a de la flor</div>
      <small>Neotech EduLab Â· InclusiÃ³n & Ciencia</small>
    </div>
  </div>
  <nav class="main-nav" aria-label="NavegaciÃ³n principal">
    <a href="index.html" class="nav-btn accent"><span>ğŸ </span><span>Inicio</span></a>
    <a href="viewer3D/flor-3d.html" class="nav-btn"><span>ğŸ‘ï¸</span><span>Ver en 3D</span></a>
    <a href="viewerAR/flor-ar.html" class="nav-btn"><span>ğŸ“±</span><span>AR</span></a>
    <a href="viewerVR/flor-vr.html" class="nav-btn"><span>ğŸ¥½</span><span>VR</span></a>
    <a href="dashboard.html" class="nav-btn"><span>ğŸ“Š</span><span>Dashboard</span></a>
    <a href="docente.html" class="nav-btn"><span>ğŸ§‘â€ğŸ«</span><span>Docente</span></a>
  </nav>
  <div class="accessibility-controls" aria-label="Controles de accesibilidad">
    <button class="ctrl-btn" type="button" data-action="home" title="Ir al inicio">ğŸ </button>
    <button class="ctrl-btn" type="button" data-action="speak" title="Leer el contenido">ğŸ—£ï¸</button>
    <button class="ctrl-btn" type="button" data-action="toggle-theme" title="Cambiar tema claro/oscuro">ğŸŒ“</button>
    <button class="ctrl-btn" type="button" data-action="font-inc" title="Aumentar tamaÃ±o de letra">A+</button>
    <button class="ctrl-btn" type="button" data-action="font-dec" title="Disminuir tamaÃ±o de letra">Aâˆ’</button>
  </div>
</header>

  <main id="main-content" class="layout">
    <section class="card">
      <h1>ğŸ“Š Dashboard de datos Â· Partes de la flor</h1>
      <p>
        Este panel muestra cuÃ¡ntas estructuras tiene una flor modelo (sÃ©palos, pÃ©talos, estambres y carpelos).
        Los datos provienen del archivo <code>anatomia_flor_partes.csv</code>. Puedes editar el CSV o usar esta
        pÃ¡gina como ejemplo para que el estudiantado construya sus propios grÃ¡ficos.
      </p>
    </section>

    <section class="card">
      <h2>ğŸŒ¼ GrÃ¡fico 1: nÃºmero de estructuras</h2>
      <p>Compara la cantidad de piezas de cada tipo en la flor modelo.</p>
      <div class="chart-wrapper">
        <canvas id="chartPartes" aria-label="GrÃ¡fico de nÃºmero de estructuras florales" role="img"></canvas>
      </div>
    </section>

    <section class="card">
      <h2>âœï¸ Datos en tabla (solo lectura)</h2>
      <div class="table-scroll">
        <table class="data-table" id="tablaDatos">
          <thead>
            <tr>
              <th>Estructura</th>
              <th>CategorÃ­a</th>
              <th>Cantidad</th>
              <th>FunciÃ³n</th>
            </tr>
          </thead>
          <tbody>
          </tbody>
        </table>
      </div>
      <p class="note">
        Sugerencia: pide al curso que mida flores reales (por ejemplo, de azucena, rosa o lirio),
        registre los datos en una copia del CSV y compare distintas especies.
      </p>
    </section>

    <section class="card">
      <h2>ğŸ“‚ Archivo de datos</h2>
      <p>Puedes descargar la plantilla y adaptarla a otras actividades:</p>
      <a href="assets/data/anatomia_flor_partes.csv" download class="cta-btn small">âœ… Descargar CSV de ejemplo</a>
    </section>
  </main>
  
<footer class="site-footer">
  <p>
    Neotech EduLab SpA Â· XR para la educaciÃ³n cientÃ­fica Â· Proyecto: <strong>"Ver la flor por dentro"</strong>.<br>
    Desarrollado junto a estudiantes y PIE para explorar la anatomÃ­a floral en 3D, AR y VR.
  </p>
  <p>
    Contacto: <a href="mailto:neotechedulab@gmail.com">neotechedulab@gmail.com</a> Â·
    Instagram: @neotech_edulab
  </p>
</footer>

  <script src="js/main.js"></script>
  <script>
    (function() {
      const CSV_URL = 'assets/data/anatomia_flor_partes.csv';

      function parseCsv(text) {
        const lines = text.trim().split(/\r?\n/);
        if (!lines.length) return { headers: [], rows: [] };
        const headers = lines[0].split(';').map(h => h.trim());
        const rows = lines.slice(1).map(line => line.split(';').map(c => c.trim()));
        return { headers, rows };
      }

      function renderTable(data) {
        const tbody = document.querySelector('#tablaDatos tbody');
        if (!tbody) return;
        tbody.innerHTML = '';
        data.rows.forEach(cells => {
          const tr = document.createElement('tr');
          tr.innerHTML = `<td>${cells[0]}</td><td>${cells[1]}</td><td>${cells[2]}</td><td>${cells[3]}</td>`;
          tbody.appendChild(tr);
        });
      }

      function buildChart(data) {
        const labels = data.rows.map(r => r[0]);
        const cantidades = data.rows.map(r => Number(r[2] || 0));
        const ctx = document.getElementById('chartPartes')?.getContext('2d');
        if (!ctx) return;

        new Chart(ctx, {
          type: 'bar',
          data: {
            labels,
            datasets: [{ label: 'Cantidad de estructuras', data: cantidades, borderWidth: 1 }]
          },
          options: {
            responsive: true,
            scales: {
              y: { beginAtZero: true, title: { display: true, text: 'NÃºmero de piezas' } }
            }
          }
        });
      }

      fetch(CSV_URL)
        .then(r => r.text())
        .then(text => { const data = parseCsv(text); renderTable(data); buildChart(data); })
        .catch(err => console.error('Error al cargar CSV', err));
    })();
  </script>
</body>
</html>
